sum(3.14159 * c(7.0, 10.0, 13.0, 16.0))
sum(3.14159 * c(42.0, 50.0, 58.0, 66.0))
sum(3.14157 * c(21.0, 26.0, 31.0, 36.0))
sum(3.14159 * c(21.0, 26.0, 31.0, 36.0))
sum(3.14159 * c(7.0, 10.0, 13.0, 16.0))
sum(3.14159 * c(28.0, 34.0, 40.0, 46.0))
640 * 480
320 * 200
640 * 350
?rpois
rpois(1,10000)
rpois(1,9949)
rpois(1,9949/10)
rpois(1,939/10)
rpois(1,1000000)
rpois(1,1002051/10)
rpois(1,100351/10)
rpois(1,9899/10)
rpois(1,980/10)
94 * 10^4
rpois(7,1000000)
rpois(7,1000000) -> s0
s0
rpois(7,s0) -> s1; s1
rpois(7,s0/10) -> s1; s1
rpois(7,s1/10) -> s2; s1
rpois(7,s2/10) -> s3; s1
rpois(7,s3/10) -> s4; s1
rpois(7,s3/10) -> s4; s4
s4 * 10^4
rpois(10000,10000000) -> s0
summary(s0)
rpois(10000,s0/10) -> s1
summary(s1)
rpois(10000,s1/10) -> s2
rpois(10000,s2/10) -> s3
rpois(10000,s3/10) -> s4
summary(s4)
rpois(10000,s4/10) -> s5
summary(s5)
hist(s5,breaks = 47)
sd(s5)
var(s5)
850 * (1.03)
875 * 12 * 10
1/24
28 * 3
84 * 8
672 / 24
assayTime <- c(1,3,8,9,24,25, 27,32, 33, 48, 49, 72, 73, 96, 97, 576, 577)
assayTime / 24
(3 + assayTime / 24)''
(3 + assayTime / 24)
assayTime
t(assayTime)
transpose(assayTime)
transpose(assayTime)''
transpose(assayTime)'
cbind(t(assayTime), t(3 + assayTime/24)
)
matrix(c(assayTime, 3 + assayTime/ 24), nrow = 2, byrow = F)
matrix(c(assayTime, 3 + assayTime/ 24), nrow = length(assayTime), byrow = F)
assayTime <- c(1,3,6,7,9,24,25,27,30, 31,33, 48,49, 72, 73, 96,97, 576,577 )
matrix(c(assayTime, 3 + assayTime/ 24), nrow = length(assayTime), byrow = F)
0.004167 * 24
outdir <- '~/src/lapk/PMcore/examples/sde_paper/output/experiment2/'
run_name <- "SDE Paper exp02"
setwd(outdir)
op <- read.csv("op.csv") # %>% filter(!id %in% c(58,218))
against <- op$post_mean
{
plot.lim = c(0,max(max(op$obs),max(against)))
plot(against, op$obs, type = "p", ylim = plot.lim, xlim = plot.lim,
, xlab = "posterior expected concentration", ylab = "observed concentration"
, main = paste("post_mean\n", run_name))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} #
# ---
BLQ = 2.0
BLQ = 2.0
{
{
op.blq <- op %>% filter(obs > BLQ)
against.blq <- op.blq$post_mean
} # op.blq <- remove BLQ observations
summary(lm(op.blq$obs ~ against.blq))
{
inter = lm(op.blq$obs ~ against.blq)[1]$coefficients[1]
sl = lm(op.blq$obs ~ against.blq)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
} # plot reg line w/out BLQ
abline(h = c(BLQ), col = "grey")
} # summary and regression line w/BLQ removed!!!
#
# ~/Documents/Drug Models/Vancomycin/NPAG_sde.R
#
# Rust code: ~/src/lapk/PMcore/examples/vanco_sde/main.rs
#
# Rscript saved in ~/Documents/Vancomycin
# data saved in: ~/Documents/Vancomycin
#
#
library(tidyverse)
# ---
BLQ = 2.0
{
{
op.blq <- op %>% filter(obs > BLQ)
against.blq <- op.blq$post_mean
} # op.blq <- remove BLQ observations
summary(lm(op.blq$obs ~ against.blq))
{
inter = lm(op.blq$obs ~ against.blq)[1]$coefficients[1]
sl = lm(op.blq$obs ~ against.blq)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
} # plot reg line w/out BLQ
abline(h = c(BLQ), col = "grey")
} # summary and regression line w/BLQ removed!!!
# ------
# ------------------------------------------------------- POPULATION FITS ---
against <- op$pop_mean # (op %>% filter(obs > 4))$pop_mean
obs <- op$obs # (op%>% filter(obs > 4))$obs
{
plot.lim = c(0,max(max(obs),max(against)))
plot(against, obs, type = "p", ylim = plot.lim, xlim = plot.lim
, xlab = "population expected concentration", ylab = "observed concentration"
, main = paste("pop_mean\n",run_name)) # , pch = as.character(op$id))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} # obs
{
summary(lm(obs ~ against))
inter = lm(obs ~ against)[1]$coefficients[1]
sl = lm(obs ~ against)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
abline(h = c(4.0), col = "grey")
} # summ
outdir <- '~/src/lapk/PMcore/examples/sde_paper/output/experiment3/'
run_name <- "SDE Paper exp03"
setwd(outdir)
op <- read.csv("op.csv") # %>% filter(!id %in% c(58,218))
against <- op$post_mean
{
plot.lim = c(0,max(max(op$obs),max(against)))
plot(against, op$obs, type = "p", ylim = plot.lim, xlim = plot.lim,
, xlab = "posterior expected concentration", ylab = "observed concentration"
, main = paste("post_mean\n", run_name))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} # ... and plot obs vs. against
BLQ = 2.0
{
{
op.blq <- op %>% filter(obs > BLQ)
against.blq <- op.blq$post_mean
} # op.blq <- remove BLQ observations
summary(lm(op.blq$obs ~ against.blq))
{
inter = lm(op.blq$obs ~ against.blq)[1]$coefficients[1]
sl = lm(op.blq$obs ~ against.blq)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
} # plot reg line w/out BLQ
abline(h = c(BLQ), col = "grey")
} # summary and regression line w/BLQ removed!!!
# ------
against <- op$pop_mean # (op %>% filter(obs > 4))$pop_mean
obs <- op$obs # (op%>% filter(obs > 4))$obs
# against <- log10(
{
plot.lim = c(0,max(max(obs),max(against)))
plot(against, obs, type = "p", ylim = plot.lim, xlim = plot.lim
, xlab = "population expected concentration", ylab = "observed concentration"
, main = paste("pop_mean\n",run_name)) # , pch = as.character(op$id))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} # obs vs. pred
# ---
outdir <- '~/src/lapk/PMcore/examples/sde_paper/output/experiment4/'
run_name <- "SDE Paper exp04"
setwd(outdir)
op <- read.csv("op.csv") # %>% filter(!id %in% c(58,218))
against <- op$post_mean
{
plot.lim = c(0,max(max(op$obs),max(against)))
plot(against, op$obs, type = "p", ylim = plot.lim, xlim = plot.lim,
, xlab = "posterior expected concentration", ylab = "observed concentration"
, main = paste("post_mean\n", run_name))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} # ... and plot obs vs. against
# ---
BLQ = 2.0
{
{
op.blq <- op %>% filter(obs > BLQ)
against.blq <- op.blq$post_mean
} # op.blq <- remove BLQ observations
summary(lm(op.blq$obs ~ against.blq))
{
inter = lm(op.blq$obs ~ against.blq)[1]$coefficients[1]
sl = lm(op.blq$obs ~ against.blq)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
} # plot reg line w/out BLQ
abline(h = c(BLQ), col = "grey")
} # summary and regression line w/BLQ removed!!!
# ------
against <- op$pop_mean # (op %>% filter(obs > 4))$pop_mean
obs <- op$obs # (o
{
plot.lim = c(0,max(max(obs),max(against)))
plot(against, obs, type = "p", ylim = plot.lim, xlim = plot.lim
, xlab = "population expected concentration", ylab = "observed concentration"
, main = paste("pop_mean\n",run_name)) # , pch = as.character(op$id))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} # ob
{
summary(lm(obs ~ against))
inter = lm(obs ~ against)[1]$coefficients[1]
sl = lm(obs ~ against)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
abline(h = c(BLQ), col = "grey")
} # summa
outdir <- '~/src/lapk/PMcore/examples/sde_paper/output/experiment0/'
run_name <- "SDE Paper exp00; ke ODE"
setwd(outdir)
op <- read.csv("op.csv") # %>% filter(!id %in% c(58,218))
against <- op$post_mean
{
plot.lim = c(0,max(max(op$obs),max(against)))
plot(against, op$obs, type = "p", ylim = plot.lim, xlim = plot.lim,
, xlab = "posterior expected concentration", ylab = "observed concentration"
, main = paste("post_mean\n", run_name))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} # ... and plot obs vs. against
BLQ = 2.0
{
{
op.blq <- op %>% filter(obs > BLQ)
against.blq <- op.blq$post_mean
} # op.blq <- remove BLQ observations
summary(lm(op.blq$obs ~ against.blq))
{
inter = lm(op.blq$obs ~ against.blq)[1]$coefficients[1]
sl = lm(op.blq$obs ~ against.blq)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
} # plot reg line w/out BLQ
abline(h = c(BLQ), col = "grey")
} #
# ------------------------------------------------------- POPULATION FITS ---
against <- op$pop_mean # (op %>% filter(obs > 4))$pop_mean
obs <- op$obs # (op%>% filter(obs > 4))$obs
{
plot.lim = c(0,max(max(obs),max(against)))
plot(against, obs, type = "p", ylim = plot.lim, xlim = plot.lim
, xlab = "population expected concentration", ylab = "observed concentration"
, main = paste("pop_mean\n",run_name)) # , pch = as.character(op$id))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} # obs vs. pred
# ---
{
summary(lm(obs ~ against))
inter = lm(obs ~ against)[1]$coefficients[1]
sl = lm(obs ~ against)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
abline(h = c(BLQ), col = "grey")
} # summary and reg
min(op$obs)
min(op$obs)/2
setwd(outdir)
op <- read.csv("op.csv") # %>% filter(!id %in% c(58,218))
against <- op$post_mean
{
plot.lim = c(0,max(max(op$obs),max(against)))
plot(against, op$obs, type = "p", ylim = plot.lim, xlim = plot.lim,
, xlab = "posterior expected concentration", ylab = "observed concentration"
, main = paste("post_mean\n", run_name))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} #
BLQ = 2.0
{
{
op.blq <- op %>% filter(obs > BLQ)
against.blq <- op.blq$post_mean
} # op.blq <- remove BLQ observations
summary(lm(op.blq$obs ~ against.blq))
{
inter = lm(op.blq$obs ~ against.blq)[1]$coefficients[1]
sl = lm(op.blq$obs ~ against.blq)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
} # plot reg line w/out BLQ
abline(h = c(BLQ), col = "grey")
} # s
against <- op$pop_mean # (op %>% filter(obs > 4))$pop_mean
obs <- op$obs # (op%>% filter(obs > 4))$obs
# against <- log10(against)
# obs <- log10(obs)
{
plot.lim = c(0,max(max(obs),max(against)))
plot(against, obs, type = "p", ylim = plot.lim, xlim = plot.lim
, xlab = "population expected concentration", ylab = "observed concentration"
, main = paste("pop_mean\n",run_name)) # , pch = as.character(op$id))
lines(c(0,max(plot.lim)),c(0,max(plot.lim)),lty = 3,lwd = 2, col = "grey")
} # obs vs. pred
# ---
{
summary(lm(obs ~ against))
inter = lm(obs ~ against)[1]$coefficients[1]
sl = lm(obs ~ against)[1]$coefficients[2]
lines(plot.lim,
inter + sl*plot.lim
, lty = 7, lwd = 3, col = "grey"
)
abline(h = c(BLQ), col = "grey")
} #
getwd()
d.prior <- read_csv("/Users/wyamada/src/lapk/PMcore/examples/sde_paper/output/experiment0/theta.csv")
plot(density(d.prior$ke))
d.prior$prob
sum(d.prior$prob)
?density
plot(d.prior$ke, weights = d.prior$prob)
d.prior$prob
plot(d.prior$ke, weights = 100*(d.prior$prob))
plot(density(d.prior$ke, weights = 100*(d.prior$prob)))
plot(density(d.prior$ke, weights = d.prior$prob))
